<script setup lang="ts">
import type { Listing } from "@/interfaces/Listing";
import { UserStore } from "@/stores/userStore";
import { storeToRefs } from "pinia";
import ListingService from "@/networking/api-services/listing.service";
import ImageCarousel from "@/components/Listing/ImageCarousel.vue";
import ListingReviews from "@/components/Listing/ListingReviews.vue";
import AccountsService from "../../networking/api-services/accounts.service";
import LocationSearchMap from "../location/LocationSearchMap.vue";
import VerifyModal from '@/components/modal/auth/VerifyModal.vue';
import { event } from 'vue-gtag'
</script>

<template>
  <div class="container mx-auto px-5">
    <div class="relative">
        <div :class="listing_id ? 'bg-white container w-full z-0 sm:-mt-2 -mt-4 py-2' : 'fixed bg-white container w-full z-10 sm:-mt-2 -mt-4 py-2'">
          <div class="sm:flex justify-between items-center" v-if="listing.length > 0">
            <div>
              <p class="text-[20px] font-bold">{{ getListing().name }}</p>
              <div class="flex sm:justify-between items-center">
                <p class="text-[16px]">
                  BDR: {{ getListing().beds }} BTH: {{ getListing().baths }} &nbsp; (Sleeps {{ getListing().max_guests }})
                </p>
                <div class="flex items-center ml-4">
                  <svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1.21836 5.42154L5.36389 4.81906L7.21706 1.06212C7.26767 0.959255 7.35094 0.875985 7.45381 0.82537C7.71178 0.698016 8.02527 0.804145 8.15425 1.06212L10.0074 4.81906L14.153 5.42155C14.2672 5.43787 14.3717 5.49175 14.4517 5.57339C14.5485 5.6728 14.6018 5.80655 14.5999 5.94523C14.5981 6.08392 14.5413 6.21621 14.442 6.31302L11.4426 9.23727L12.1512 13.3665C12.1678 13.4625 12.1572 13.5613 12.1205 13.6516C12.0839 13.742 12.0226 13.8202 11.9437 13.8775C11.8649 13.9348 11.7715 13.9688 11.6743 13.9757C11.5771 13.9827 11.4798 13.9622 11.3936 13.9167L7.68566 11.9672L3.97769 13.9167C3.87646 13.9706 3.75891 13.9886 3.64625 13.969C3.36215 13.92 3.17112 13.6506 3.2201 13.3665L3.92871 9.23727L0.929361 6.31302C0.847724 6.23302 0.793844 6.12852 0.777517 6.01423C0.733432 5.7285 0.932626 5.464 1.21836 5.42154Z" fill="black"/>
                  </svg>
                  <span class="font-bold">
                    {{getListing().rating}}
                  </span>
                  <span class="text-gray-500">
                    &nbsp;({{getListing().total_reviews }})
                  </span>
                </div>
              </div>
            </div>
            <div class="sm:flex items-center">
              <div class="">
                <p class="font-bold"></p>
                <p><span class="font-bold">${{ getListing().average_price }}</span>/night (average)</p>
              </div>
              <div class="sm:ml-2">
                <button  class="bg-[#F3A24D] text-white font-bold text-[16px] sm:w-[200px] sm:h-[32px] p-2 sm:p-0 mt-2 sm:mt-0 rounded-full" @click="connectHost(getListing().connection_url ? getListing().connection_url : getListing().listing_url)">
                  Connect with Host
                </button>
              </div>
            </div>
          </div>
        </div>
        <div v-if="listing.length > 0">
          <div :class="listing_id ? 'w-full' : 'w-9/12 m-auto'">
            <div class="flex">
              <div :class="listing_id ? 'w-full h-[350px] md:h-[600px]' : 'w-full h-[350px] md:h-[600px] mt-16'">
                <ImageCarousel :images="getListing().images"/>
              </div>
            </div>

            <div class="flex mt-4 justify-end">
              <div>
                <span @click="openModal">
                  <svg v-if="favoritePages.length > 0" class="w-6 cursor-pointer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z"/></svg>
                  <svg v-else class="w-6 cursor-pointer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M287.9 0C297.1 0 305.5 5.25 309.5 13.52L378.1 154.8L531.4 177.5C540.4 178.8 547.8 185.1 550.7 193.7C553.5 202.4 551.2 211.9 544.8 218.2L433.6 328.4L459.9 483.9C461.4 492.9 457.7 502.1 450.2 507.4C442.8 512.7 432.1 513.4 424.9 509.1L287.9 435.9L150.1 509.1C142.9 513.4 133.1 512.7 125.6 507.4C118.2 502.1 114.5 492.9 115.1 483.9L142.2 328.4L31.11 218.2C24.65 211.9 22.36 202.4 25.2 193.7C28.03 185.1 35.5 178.8 44.49 177.5L197.7 154.8L266.3 13.52C270.4 5.249 278.7 0 287.9 0L287.9 0zM287.9 78.95L235.4 187.2C231.9 194.3 225.1 199.3 217.3 200.5L98.98 217.9L184.9 303C190.4 308.5 192.9 316.4 191.6 324.1L171.4 443.7L276.6 387.5C283.7 383.7 292.2 383.7 299.2 387.5L404.4 443.7L384.2 324.1C382.9 316.4 385.5 308.5 391 303L476.9 217.9L358.6 200.5C350.7 199.3 343.9 194.3 340.5 187.2L287.9 78.95z"/></svg>
                </span>

              </div>
            </div>

            <div class="mt-2">
              <p class="font-bold text-[24px]">{{ getListing().headline }}</p>
              <div class="mt-6 border"></div>

              <p class="mt-3">{{ getListing().accommodations_summary }}</p>

              <div class="mt-6">
                <div v-if="getListing().description.length <= 300">
                  {{ getListing().description }}
                </div>
                <div v-else>
                  <p>
                    {{ getListing().description.slice(0, 300) }}...
                    <p
                    class="font-bold cursor-pointer mt-6"
                    v-on:click="showFullDescription = true"
                    >View more</p
                  >
                  </p>
                </div>
                <div class="mt-6 border"></div>
              </div>
            </div>

            <div class="mt-6">
              <p class="font-bold text-[20px]">Amenities</p>
              <div class="mt-6 flex">
                <div class="w-52"
                  v-for="(amenity, index) in getListing().amenities.slice(
                    0,
                    Math.min(getListing().amenities.length, 3)
                  )"
                  :key="index"
                >
                  <p :class="index == 0 ? 'flex items-center' : 'flex w-46 items-center'" >
                    <span  v-if="amenity.name=='Wifi'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1.66666 8.33333C6.66666 2.7775 13.3333 2.7775 18.3333 8.33333M5 11.6667C8 8.33333 12 8.33333 15 11.6667" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 15.8333C10.4602 15.8333 10.8333 15.4602 10.8333 15C10.8333 14.5398 10.4602 14.1667 10 14.1667C9.53976 14.1667 9.16666 14.5398 9.16666 15C9.16666 15.4602 9.53976 15.8333 10 15.8333Z" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Pool'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 18 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13.1667 3.73333C13.4963 3.73333 13.8185 3.63558 14.0926 3.45244C14.3667 3.26931 14.5803 3.00901 14.7065 2.70447C14.8326 2.39992 14.8656 2.06481 14.8013 1.74151C14.737 1.41821 14.5783 1.12124 14.3452 0.88815C14.1121 0.655063 13.8151 0.496328 13.4918 0.432019C13.1685 0.36771 12.8334 0.400716 12.5289 0.526862C12.2243 0.653008 11.964 0.866629 11.7809 1.14071C11.5977 1.41479 11.5 1.73703 11.5 2.06666C11.5 2.50869 11.6756 2.93261 11.9882 3.24517C12.3007 3.55773 12.7246 3.73333 13.1667 3.73333ZM1.25833 7.59999C1.42346 7.65278 1.58265 7.7226 1.73333 7.80833C2.25161 8.1115 2.84123 8.2713 3.44167 8.2713C4.0421 8.2713 4.63173 8.1115 5.15 7.80833C5.4759 7.62585 5.84316 7.53003 6.21667 7.53003C6.59017 7.53003 6.95744 7.62585 7.28333 7.80833L7.45833 7.89166C7.964 8.13784 8.52219 8.25666 9.08428 8.23778C9.64637 8.21889 10.1953 8.06288 10.6833 7.78333C11.0092 7.60085 11.3765 7.50503 11.75 7.50503C12.1235 7.50503 12.4908 7.60085 12.8167 7.78333C13.3448 8.08515 13.9417 8.24587 14.55 8.24999C15.137 8.2439 15.7119 8.08292 16.2167 7.78333C16.3673 7.6976 16.5265 7.62778 16.6917 7.575C16.8148 7.56652 16.9346 7.53078 17.0422 7.47036C17.1499 7.40994 17.2428 7.32635 17.3142 7.22564C17.3856 7.12493 17.4338 7.00961 17.4552 6.88802C17.4766 6.76643 17.4707 6.6416 17.4379 6.52257C17.4052 6.40353 17.3464 6.29326 17.2658 6.19972C17.1852 6.10619 17.0849 6.03172 16.972 5.98172C16.8591 5.93171 16.7365 5.90741 16.6131 5.91057C16.4897 5.91373 16.3685 5.94427 16.2583 5.99999C15.9676 6.09024 15.688 6.21325 15.425 6.36666C15.159 6.52026 14.8572 6.60112 14.55 6.60112C14.2428 6.60112 13.941 6.52026 13.675 6.36666C13.0977 6.041 12.4461 5.86988 11.7833 5.86988C11.1205 5.86988 10.4689 6.041 9.89167 6.36666C9.81327 6.40498 9.73256 6.43838 9.65 6.46666L10.95 5.16666C10.9798 5.12806 11.005 5.08611 11.025 5.04166C11.0627 5.00067 11.0962 4.956 11.125 4.90833C11.1289 4.85562 11.1289 4.8027 11.125 4.74999C11.1297 4.69732 11.1297 4.64433 11.125 4.59166C11.129 4.54174 11.129 4.49158 11.125 4.44166C11.1297 4.38899 11.1297 4.336 11.125 4.28333C11.1003 4.23434 11.0725 4.18702 11.0417 4.14166C11.02 4.09366 10.992 4.04881 10.9583 4.00833L8.4 1.23333C8.3327 1.15995 8.25389 1.09803 8.16667 1.04999C8.10859 1.04231 8.04975 1.04231 7.99167 1.04999C7.94475 1.04237 7.89692 1.04237 7.85 1.04999C7.73907 1.00536 7.61899 0.988203 7.5 0.999995L4.55 2.09999C4.3423 2.17521 4.17297 2.32982 4.07921 2.52983C3.98546 2.72985 3.97495 2.9589 4.05 3.16666C4.12522 3.37436 4.27982 3.54369 4.47984 3.63745C4.67985 3.73121 4.90891 3.74171 5.11667 3.66666L7.55833 2.77499L9.225 4.54166L7.64167 6.12499C7.11117 5.91877 6.54155 5.83273 5.97381 5.87308C5.40607 5.91343 4.85434 6.07915 4.35833 6.35833C4.0923 6.51192 3.79052 6.59278 3.48333 6.59278C3.17615 6.59278 2.87437 6.51192 2.60833 6.35833C2.34535 6.20492 2.06578 6.08191 1.775 5.99166C1.66838 5.95188 1.55473 5.93436 1.44108 5.94018C1.32742 5.946 1.21616 5.97504 1.11416 6.0255C1.01216 6.07597 0.921573 6.14679 0.847989 6.23361C0.774406 6.32042 0.719385 6.42139 0.686318 6.53028C0.65325 6.63918 0.642838 6.75369 0.655722 6.86677C0.668606 6.97984 0.704514 7.08907 0.761231 7.18774C0.817949 7.2864 0.894274 7.3724 0.985502 7.44044C1.07673 7.50847 1.18093 7.5571 1.29167 7.58333L1.25833 7.59999ZM16.2583 10.175C15.9676 10.2652 15.688 10.3883 15.425 10.5417C15.159 10.6953 14.8572 10.7761 14.55 10.7761C14.2428 10.7761 13.941 10.6953 13.675 10.5417C13.0977 10.216 12.4461 10.0449 11.7833 10.0449C11.1205 10.0449 10.4689 10.216 9.89167 10.5417C9.62338 10.6975 9.31862 10.7796 9.00834 10.7796C8.69805 10.7796 8.39329 10.6975 8.125 10.5417C7.54772 10.216 6.89614 10.0449 6.23333 10.0449C5.57053 10.0449 4.91895 10.216 4.34167 10.5417C4.07563 10.6953 3.77386 10.7761 3.46667 10.7761C3.15948 10.7761 2.8577 10.6953 2.59167 10.5417C2.32868 10.3883 2.04911 10.2652 1.75833 10.175C1.65171 10.1352 1.53807 10.1177 1.42441 10.1235C1.31076 10.1293 1.1995 10.1584 1.09749 10.2088C0.995491 10.2593 0.904906 10.3301 0.831323 10.4169C0.75774 10.5038 0.702719 10.6047 0.669651 10.7136C0.636584 10.8225 0.626171 10.937 0.639055 11.0501C0.651939 11.1632 0.687847 11.2724 0.744565 11.3711C0.801282 11.4697 0.877607 11.5557 0.968835 11.6238C1.06006 11.6918 1.16426 11.7404 1.275 11.7667C1.44013 11.8194 1.59932 11.8893 1.75 11.975C2.26828 12.2782 2.8579 12.438 3.45833 12.438C4.05877 12.438 4.64839 12.2782 5.16667 11.975C5.49257 11.7925 5.85983 11.6967 6.23333 11.6967C6.60684 11.6967 6.9741 11.7925 7.3 11.975C7.82275 12.2739 8.41449 12.4311 9.01667 12.4311C9.61884 12.4311 10.2106 12.2739 10.7333 11.975C11.0592 11.7925 11.4265 11.6967 11.8 11.6967C12.1735 11.6967 12.5408 11.7925 12.8667 11.975C13.3948 12.2768 13.9917 12.4375 14.6 12.4417C15.187 12.4356 15.7619 12.2746 16.2667 11.975C16.4173 11.8893 16.5765 11.8194 16.7417 11.7667C16.8467 11.7349 16.9445 11.6828 17.0294 11.6133C17.1143 11.5438 17.1847 11.4582 17.2366 11.3615C17.2884 11.2647 17.3207 11.1587 17.3316 11.0495C17.3425 10.9403 17.3317 10.8301 17.3 10.725C17.2683 10.6199 17.2161 10.5222 17.1466 10.4372C17.0771 10.3523 16.9915 10.2819 16.8948 10.2301C16.7981 10.1782 16.6921 10.146 16.5829 10.1351C16.4737 10.1242 16.3634 10.1349 16.2583 10.1667V10.175Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Security'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.5 12.5V10.625C12.5 9.96195 12.2366 9.32607 11.7678 8.85723C11.2989 8.38839 10.663 8.12499 10 8.12499C9.33696 8.12499 8.70107 8.38839 8.23223 8.85723C7.76339 9.32607 7.5 9.96195 7.5 10.625V12.5C7.16858 12.5003 6.85083 12.6321 6.61648 12.8665C6.38213 13.1008 6.25033 13.4186 6.25 13.75V17.5C6.25033 17.8314 6.38213 18.1492 6.61648 18.3835C6.85083 18.6179 7.16858 18.7497 7.5 18.75H12.5C12.8314 18.7497 13.1492 18.6179 13.3835 18.3835C13.6179 18.1492 13.7497 17.8314 13.75 17.5V13.75C13.7497 13.4186 13.6179 13.1008 13.3835 12.8665C13.1492 12.6321 12.8314 12.5003 12.5 12.5ZM8.75 10.625C8.75 10.2935 8.8817 9.97553 9.11612 9.74111C9.35054 9.50669 9.66848 9.37499 10 9.37499C10.3315 9.37499 10.6495 9.50669 10.8839 9.74111C11.1183 9.97553 11.25 10.2935 11.25 10.625V12.5H8.75V10.625ZM7.5 17.5V13.75H12.5V17.5H7.5ZM3.81562 4.44062L4.69937 5.32437C5.39488 4.62724 6.22107 4.07416 7.13063 3.69678C8.04019 3.31941 9.01526 3.12516 10 3.12516C10.9847 3.12516 11.9598 3.31941 12.8694 3.69678C13.7789 4.07416 14.6051 4.62724 15.3006 5.32437L16.1844 4.44062C15.3729 3.62731 14.4089 2.98205 13.3477 2.54179C12.2865 2.10153 11.1489 1.87491 10 1.87491C8.85109 1.87491 7.71347 2.10153 6.65226 2.54179C5.59106 2.98205 4.62711 3.62731 3.81562 4.44062Z" fill="black"/>
                        <path d="M10 5C9.26141 4.99963 8.53002 5.1452 7.84786 5.42836C7.1657 5.71153 6.54622 6.12669 6.025 6.65L6.9075 7.53313C7.31325 7.12647 7.79522 6.80384 8.32582 6.58371C8.85642 6.36358 9.42524 6.25027 9.99969 6.25027C10.5741 6.25027 11.143 6.36358 11.6736 6.58371C12.2042 6.80384 12.6861 7.12647 13.0919 7.53313L13.9756 6.64938C13.4542 6.12616 12.8346 5.7111 12.1524 5.42805C11.4701 5.145 10.7386 4.99953 10 5Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Oven'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 3.125C2.38494 3.125 2.29167 3.21827 2.29167 3.33333V14.1667C2.29167 14.2817 2.38494 14.375 2.5 14.375H17.5C17.6151 14.375 17.7083 14.2817 17.7083 14.1667V3.33333C17.7083 3.21827 17.6151 3.125 17.5 3.125H2.5ZM1.04167 3.33333C1.04167 2.52792 1.69459 1.875 2.5 1.875H17.5C18.3054 1.875 18.9583 2.52792 18.9583 3.33333V14.1667C18.9583 14.9721 18.3054 15.625 17.5 15.625H2.5C1.69459 15.625 1.04167 14.9721 1.04167 14.1667V3.33333Z" fill="black"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M3.54167 6.25C3.54167 5.90482 3.82149 5.625 4.16667 5.625H11.25C11.5952 5.625 11.875 5.90482 11.875 6.25V11.25C11.875 11.5952 11.5952 11.875 11.25 11.875H4.16667C3.82149 11.875 3.54167 11.5952 3.54167 11.25V6.25ZM4.79167 6.875V10.625H10.625V6.875H4.79167ZM13.5417 6.25C13.5417 5.90482 13.8215 5.625 14.1667 5.625H15.8333C16.1785 5.625 16.4583 5.90482 16.4583 6.25C16.4583 6.59518 16.1785 6.875 15.8333 6.875H14.1667C13.8215 6.875 13.5417 6.59518 13.5417 6.25ZM13.5417 8.75C13.5417 8.40482 13.8215 8.125 14.1667 8.125H15.8333C16.1785 8.125 16.4583 8.40482 16.4583 8.75C16.4583 9.09518 16.1785 9.375 15.8333 9.375H14.1667C13.8215 9.375 13.5417 9.09518 13.5417 8.75Z" fill="black"/>
                        <path d="M15 12.0833C15.4602 12.0833 15.8333 11.7102 15.8333 11.25C15.8333 10.7898 15.4602 10.4167 15 10.4167C14.5398 10.4167 14.1667 10.7898 14.1667 11.25C14.1667 11.7102 14.5398 12.0833 15 12.0833Z" fill="black"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5 14.375C5.34518 14.375 5.625 14.6548 5.625 15V17.5C5.625 17.8452 5.34518 18.125 5 18.125C4.65482 18.125 4.375 17.8452 4.375 17.5V15C4.375 14.6548 4.65482 14.375 5 14.375ZM15 14.375C15.3452 14.375 15.625 14.6548 15.625 15V17.5C15.625 17.8452 15.3452 18.125 15 18.125C14.6548 18.125 14.375 17.8452 14.375 17.5V15C14.375 14.6548 14.6548 14.375 15 14.375Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Washer'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.66666 5.83334C6.90277 5.83334 7.10083 5.75362 7.26083 5.59417C7.42027 5.43417 7.49999 5.23612 7.49999 5.00001C7.49999 4.76389 7.42027 4.56584 7.26083 4.40584C7.10083 4.24639 6.90277 4.16667 6.66666 4.16667C6.43055 4.16667 6.2325 4.24639 6.07249 4.40584C5.91305 4.56584 5.83333 4.76389 5.83333 5.00001C5.83333 5.23612 5.91305 5.43417 6.07249 5.59417C6.2325 5.75362 6.43055 5.83334 6.66666 5.83334ZM9.16666 5.83334C9.40277 5.83334 9.60083 5.75362 9.76083 5.59417C9.92027 5.43417 9.99999 5.23612 9.99999 5.00001C9.99999 4.76389 9.92027 4.56584 9.76083 4.40584C9.60083 4.24639 9.40277 4.16667 9.16666 4.16667C8.93055 4.16667 8.73277 4.24639 8.57333 4.40584C8.41333 4.56584 8.33333 4.76389 8.33333 5.00001C8.33333 5.23612 8.41333 5.43417 8.57333 5.59417C8.73277 5.75362 8.93055 5.83334 9.16666 5.83334ZM9.99999 15C10.875 15 11.6217 14.7014 12.24 14.1042C12.8578 13.5069 13.1667 12.7778 13.1667 11.9167C13.1667 11.5139 13.0972 11.1214 12.9583 10.7392C12.8194 10.3575 12.6111 10.0278 12.3333 9.75L9.99999 7.41667L7.74999 9.66667C7.44444 9.97223 7.21194 10.3158 7.0525 10.6975C6.8925 11.0797 6.81944 11.4861 6.83333 11.9167C6.86111 12.7778 7.18055 13.5069 7.79166 14.1042C8.40277 14.7014 9.13888 15 9.99999 15ZM9.99999 13.4167C9.58333 13.4167 9.22916 13.2708 8.9375 12.9792C8.64583 12.6875 8.49999 12.3333 8.49999 11.9167C8.49999 11.7083 8.53833 11.5103 8.615 11.3225C8.69111 11.1353 8.80555 10.9653 8.95833 10.8125L9.99999 9.77084L11.0208 10.7917C11.1736 10.9444 11.2917 11.1181 11.375 11.3125C11.4583 11.5069 11.5 11.7083 11.5 11.9167C11.5 12.3333 11.3542 12.6875 11.0625 12.9792C10.7708 13.2708 10.4167 13.4167 9.99999 13.4167ZM4.99999 18.3333C4.54166 18.3333 4.14944 18.1703 3.82333 17.8442C3.49666 17.5175 3.33333 17.125 3.33333 16.6667V3.33334C3.33333 2.87501 3.49666 2.4825 3.82333 2.15584C4.14944 1.82973 4.54166 1.66667 4.99999 1.66667H15C15.4583 1.66667 15.8508 1.82973 16.1775 2.15584C16.5036 2.4825 16.6667 2.87501 16.6667 3.33334V16.6667C16.6667 17.125 16.5036 17.5175 16.1775 17.8442C15.8508 18.1703 15.4583 18.3333 15 18.3333H4.99999ZM4.99999 16.6667H15V3.33334H4.99999V16.6667ZM4.99999 16.6667V3.33334V16.6667Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Dryer'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.66666 5.83334C6.90277 5.83334 7.10083 5.75362 7.26083 5.59417C7.42027 5.43417 7.49999 5.23612 7.49999 5.00001C7.49999 4.76389 7.42027 4.56584 7.26083 4.40584C7.10083 4.24639 6.90277 4.16667 6.66666 4.16667C6.43055 4.16667 6.2325 4.24639 6.07249 4.40584C5.91305 4.56584 5.83333 4.76389 5.83333 5.00001C5.83333 5.23612 5.91305 5.43417 6.07249 5.59417C6.2325 5.75362 6.43055 5.83334 6.66666 5.83334ZM9.16666 5.83334C9.40277 5.83334 9.60083 5.75362 9.76083 5.59417C9.92027 5.43417 9.99999 5.23612 9.99999 5.00001C9.99999 4.76389 9.92027 4.56584 9.76083 4.40584C9.60083 4.24639 9.40277 4.16667 9.16666 4.16667C8.93055 4.16667 8.73277 4.24639 8.57333 4.40584C8.41333 4.56584 8.33333 4.76389 8.33333 5.00001C8.33333 5.23612 8.41333 5.43417 8.57333 5.59417C8.73277 5.75362 8.93055 5.83334 9.16666 5.83334ZM9.99999 15C10.875 15 11.6217 14.7014 12.24 14.1042C12.8578 13.5069 13.1667 12.7778 13.1667 11.9167C13.1667 11.5139 13.0972 11.1214 12.9583 10.7392C12.8194 10.3575 12.6111 10.0278 12.3333 9.75L9.99999 7.41667L7.74999 9.66667C7.44444 9.97223 7.21194 10.3158 7.0525 10.6975C6.8925 11.0797 6.81944 11.4861 6.83333 11.9167C6.86111 12.7778 7.18055 13.5069 7.79166 14.1042C8.40277 14.7014 9.13888 15 9.99999 15ZM9.99999 13.4167C9.58333 13.4167 9.22916 13.2708 8.9375 12.9792C8.64583 12.6875 8.49999 12.3333 8.49999 11.9167C8.49999 11.7083 8.53833 11.5103 8.615 11.3225C8.69111 11.1353 8.80555 10.9653 8.95833 10.8125L9.99999 9.77084L11.0208 10.7917C11.1736 10.9444 11.2917 11.1181 11.375 11.3125C11.4583 11.5069 11.5 11.7083 11.5 11.9167C11.5 12.3333 11.3542 12.6875 11.0625 12.9792C10.7708 13.2708 10.4167 13.4167 9.99999 13.4167ZM4.99999 18.3333C4.54166 18.3333 4.14944 18.1703 3.82333 17.8442C3.49666 17.5175 3.33333 17.125 3.33333 16.6667V3.33334C3.33333 2.87501 3.49666 2.4825 3.82333 2.15584C4.14944 1.82973 4.54166 1.66667 4.99999 1.66667H15C15.4583 1.66667 15.8508 1.82973 16.1775 2.15584C16.5036 2.4825 16.6667 2.87501 16.6667 3.33334V16.6667C16.6667 17.125 16.5036 17.5175 16.1775 17.8442C15.8508 18.1703 15.4583 18.3333 15 18.3333H4.99999ZM4.99999 16.6667H15V3.33334H4.99999V16.6667ZM4.99999 16.6667V3.33334V16.6667Z" fill="black"/>
                      </svg>
                    </span>
                    <span>{{ amenity.name }}</span>
                  </p>

                </div>
              </div>
              <div class="mt-2 flex">
                <div class="w-52"
                  v-for="(amenity, index) in getListing().amenities.slice(
                    4,
                    Math.min(getListing().amenities.length, 7)
                  )"
                  :key="index"
                >
                  <p :class="index == 0 ? 'flex items-center' : 'flex items-center'" >
                    <span  v-if="amenity.name=='Wifi'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1.66666 8.33333C6.66666 2.7775 13.3333 2.7775 18.3333 8.33333M5 11.6667C8 8.33333 12 8.33333 15 11.6667" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 15.8333C10.4602 15.8333 10.8333 15.4602 10.8333 15C10.8333 14.5398 10.4602 14.1667 10 14.1667C9.53976 14.1667 9.16666 14.5398 9.16666 15C9.16666 15.4602 9.53976 15.8333 10 15.8333Z" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Pool'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 18 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13.1667 3.73333C13.4963 3.73333 13.8185 3.63558 14.0926 3.45244C14.3667 3.26931 14.5803 3.00901 14.7065 2.70447C14.8326 2.39992 14.8656 2.06481 14.8013 1.74151C14.737 1.41821 14.5783 1.12124 14.3452 0.88815C14.1121 0.655063 13.8151 0.496328 13.4918 0.432019C13.1685 0.36771 12.8334 0.400716 12.5289 0.526862C12.2243 0.653008 11.964 0.866629 11.7809 1.14071C11.5977 1.41479 11.5 1.73703 11.5 2.06666C11.5 2.50869 11.6756 2.93261 11.9882 3.24517C12.3007 3.55773 12.7246 3.73333 13.1667 3.73333ZM1.25833 7.59999C1.42346 7.65278 1.58265 7.7226 1.73333 7.80833C2.25161 8.1115 2.84123 8.2713 3.44167 8.2713C4.0421 8.2713 4.63173 8.1115 5.15 7.80833C5.4759 7.62585 5.84316 7.53003 6.21667 7.53003C6.59017 7.53003 6.95744 7.62585 7.28333 7.80833L7.45833 7.89166C7.964 8.13784 8.52219 8.25666 9.08428 8.23778C9.64637 8.21889 10.1953 8.06288 10.6833 7.78333C11.0092 7.60085 11.3765 7.50503 11.75 7.50503C12.1235 7.50503 12.4908 7.60085 12.8167 7.78333C13.3448 8.08515 13.9417 8.24587 14.55 8.24999C15.137 8.2439 15.7119 8.08292 16.2167 7.78333C16.3673 7.6976 16.5265 7.62778 16.6917 7.575C16.8148 7.56652 16.9346 7.53078 17.0422 7.47036C17.1499 7.40994 17.2428 7.32635 17.3142 7.22564C17.3856 7.12493 17.4338 7.00961 17.4552 6.88802C17.4766 6.76643 17.4707 6.6416 17.4379 6.52257C17.4052 6.40353 17.3464 6.29326 17.2658 6.19972C17.1852 6.10619 17.0849 6.03172 16.972 5.98172C16.8591 5.93171 16.7365 5.90741 16.6131 5.91057C16.4897 5.91373 16.3685 5.94427 16.2583 5.99999C15.9676 6.09024 15.688 6.21325 15.425 6.36666C15.159 6.52026 14.8572 6.60112 14.55 6.60112C14.2428 6.60112 13.941 6.52026 13.675 6.36666C13.0977 6.041 12.4461 5.86988 11.7833 5.86988C11.1205 5.86988 10.4689 6.041 9.89167 6.36666C9.81327 6.40498 9.73256 6.43838 9.65 6.46666L10.95 5.16666C10.9798 5.12806 11.005 5.08611 11.025 5.04166C11.0627 5.00067 11.0962 4.956 11.125 4.90833C11.1289 4.85562 11.1289 4.8027 11.125 4.74999C11.1297 4.69732 11.1297 4.64433 11.125 4.59166C11.129 4.54174 11.129 4.49158 11.125 4.44166C11.1297 4.38899 11.1297 4.336 11.125 4.28333C11.1003 4.23434 11.0725 4.18702 11.0417 4.14166C11.02 4.09366 10.992 4.04881 10.9583 4.00833L8.4 1.23333C8.3327 1.15995 8.25389 1.09803 8.16667 1.04999C8.10859 1.04231 8.04975 1.04231 7.99167 1.04999C7.94475 1.04237 7.89692 1.04237 7.85 1.04999C7.73907 1.00536 7.61899 0.988203 7.5 0.999995L4.55 2.09999C4.3423 2.17521 4.17297 2.32982 4.07921 2.52983C3.98546 2.72985 3.97495 2.9589 4.05 3.16666C4.12522 3.37436 4.27982 3.54369 4.47984 3.63745C4.67985 3.73121 4.90891 3.74171 5.11667 3.66666L7.55833 2.77499L9.225 4.54166L7.64167 6.12499C7.11117 5.91877 6.54155 5.83273 5.97381 5.87308C5.40607 5.91343 4.85434 6.07915 4.35833 6.35833C4.0923 6.51192 3.79052 6.59278 3.48333 6.59278C3.17615 6.59278 2.87437 6.51192 2.60833 6.35833C2.34535 6.20492 2.06578 6.08191 1.775 5.99166C1.66838 5.95188 1.55473 5.93436 1.44108 5.94018C1.32742 5.946 1.21616 5.97504 1.11416 6.0255C1.01216 6.07597 0.921573 6.14679 0.847989 6.23361C0.774406 6.32042 0.719385 6.42139 0.686318 6.53028C0.65325 6.63918 0.642838 6.75369 0.655722 6.86677C0.668606 6.97984 0.704514 7.08907 0.761231 7.18774C0.817949 7.2864 0.894274 7.3724 0.985502 7.44044C1.07673 7.50847 1.18093 7.5571 1.29167 7.58333L1.25833 7.59999ZM16.2583 10.175C15.9676 10.2652 15.688 10.3883 15.425 10.5417C15.159 10.6953 14.8572 10.7761 14.55 10.7761C14.2428 10.7761 13.941 10.6953 13.675 10.5417C13.0977 10.216 12.4461 10.0449 11.7833 10.0449C11.1205 10.0449 10.4689 10.216 9.89167 10.5417C9.62338 10.6975 9.31862 10.7796 9.00834 10.7796C8.69805 10.7796 8.39329 10.6975 8.125 10.5417C7.54772 10.216 6.89614 10.0449 6.23333 10.0449C5.57053 10.0449 4.91895 10.216 4.34167 10.5417C4.07563 10.6953 3.77386 10.7761 3.46667 10.7761C3.15948 10.7761 2.8577 10.6953 2.59167 10.5417C2.32868 10.3883 2.04911 10.2652 1.75833 10.175C1.65171 10.1352 1.53807 10.1177 1.42441 10.1235C1.31076 10.1293 1.1995 10.1584 1.09749 10.2088C0.995491 10.2593 0.904906 10.3301 0.831323 10.4169C0.75774 10.5038 0.702719 10.6047 0.669651 10.7136C0.636584 10.8225 0.626171 10.937 0.639055 11.0501C0.651939 11.1632 0.687847 11.2724 0.744565 11.3711C0.801282 11.4697 0.877607 11.5557 0.968835 11.6238C1.06006 11.6918 1.16426 11.7404 1.275 11.7667C1.44013 11.8194 1.59932 11.8893 1.75 11.975C2.26828 12.2782 2.8579 12.438 3.45833 12.438C4.05877 12.438 4.64839 12.2782 5.16667 11.975C5.49257 11.7925 5.85983 11.6967 6.23333 11.6967C6.60684 11.6967 6.9741 11.7925 7.3 11.975C7.82275 12.2739 8.41449 12.4311 9.01667 12.4311C9.61884 12.4311 10.2106 12.2739 10.7333 11.975C11.0592 11.7925 11.4265 11.6967 11.8 11.6967C12.1735 11.6967 12.5408 11.7925 12.8667 11.975C13.3948 12.2768 13.9917 12.4375 14.6 12.4417C15.187 12.4356 15.7619 12.2746 16.2667 11.975C16.4173 11.8893 16.5765 11.8194 16.7417 11.7667C16.8467 11.7349 16.9445 11.6828 17.0294 11.6133C17.1143 11.5438 17.1847 11.4582 17.2366 11.3615C17.2884 11.2647 17.3207 11.1587 17.3316 11.0495C17.3425 10.9403 17.3317 10.8301 17.3 10.725C17.2683 10.6199 17.2161 10.5222 17.1466 10.4372C17.0771 10.3523 16.9915 10.2819 16.8948 10.2301C16.7981 10.1782 16.6921 10.146 16.5829 10.1351C16.4737 10.1242 16.3634 10.1349 16.2583 10.1667V10.175Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Security'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.5 12.5V10.625C12.5 9.96195 12.2366 9.32607 11.7678 8.85723C11.2989 8.38839 10.663 8.12499 10 8.12499C9.33696 8.12499 8.70107 8.38839 8.23223 8.85723C7.76339 9.32607 7.5 9.96195 7.5 10.625V12.5C7.16858 12.5003 6.85083 12.6321 6.61648 12.8665C6.38213 13.1008 6.25033 13.4186 6.25 13.75V17.5C6.25033 17.8314 6.38213 18.1492 6.61648 18.3835C6.85083 18.6179 7.16858 18.7497 7.5 18.75H12.5C12.8314 18.7497 13.1492 18.6179 13.3835 18.3835C13.6179 18.1492 13.7497 17.8314 13.75 17.5V13.75C13.7497 13.4186 13.6179 13.1008 13.3835 12.8665C13.1492 12.6321 12.8314 12.5003 12.5 12.5ZM8.75 10.625C8.75 10.2935 8.8817 9.97553 9.11612 9.74111C9.35054 9.50669 9.66848 9.37499 10 9.37499C10.3315 9.37499 10.6495 9.50669 10.8839 9.74111C11.1183 9.97553 11.25 10.2935 11.25 10.625V12.5H8.75V10.625ZM7.5 17.5V13.75H12.5V17.5H7.5ZM3.81562 4.44062L4.69937 5.32437C5.39488 4.62724 6.22107 4.07416 7.13063 3.69678C8.04019 3.31941 9.01526 3.12516 10 3.12516C10.9847 3.12516 11.9598 3.31941 12.8694 3.69678C13.7789 4.07416 14.6051 4.62724 15.3006 5.32437L16.1844 4.44062C15.3729 3.62731 14.4089 2.98205 13.3477 2.54179C12.2865 2.10153 11.1489 1.87491 10 1.87491C8.85109 1.87491 7.71347 2.10153 6.65226 2.54179C5.59106 2.98205 4.62711 3.62731 3.81562 4.44062Z" fill="black"/>
                        <path d="M10 5C9.26141 4.99963 8.53002 5.1452 7.84786 5.42836C7.1657 5.71153 6.54622 6.12669 6.025 6.65L6.9075 7.53313C7.31325 7.12647 7.79522 6.80384 8.32582 6.58371C8.85642 6.36358 9.42524 6.25027 9.99969 6.25027C10.5741 6.25027 11.143 6.36358 11.6736 6.58371C12.2042 6.80384 12.6861 7.12647 13.0919 7.53313L13.9756 6.64938C13.4542 6.12616 12.8346 5.7111 12.1524 5.42805C11.4701 5.145 10.7386 4.99953 10 5Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Oven'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 3.125C2.38494 3.125 2.29167 3.21827 2.29167 3.33333V14.1667C2.29167 14.2817 2.38494 14.375 2.5 14.375H17.5C17.6151 14.375 17.7083 14.2817 17.7083 14.1667V3.33333C17.7083 3.21827 17.6151 3.125 17.5 3.125H2.5ZM1.04167 3.33333C1.04167 2.52792 1.69459 1.875 2.5 1.875H17.5C18.3054 1.875 18.9583 2.52792 18.9583 3.33333V14.1667C18.9583 14.9721 18.3054 15.625 17.5 15.625H2.5C1.69459 15.625 1.04167 14.9721 1.04167 14.1667V3.33333Z" fill="black"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M3.54167 6.25C3.54167 5.90482 3.82149 5.625 4.16667 5.625H11.25C11.5952 5.625 11.875 5.90482 11.875 6.25V11.25C11.875 11.5952 11.5952 11.875 11.25 11.875H4.16667C3.82149 11.875 3.54167 11.5952 3.54167 11.25V6.25ZM4.79167 6.875V10.625H10.625V6.875H4.79167ZM13.5417 6.25C13.5417 5.90482 13.8215 5.625 14.1667 5.625H15.8333C16.1785 5.625 16.4583 5.90482 16.4583 6.25C16.4583 6.59518 16.1785 6.875 15.8333 6.875H14.1667C13.8215 6.875 13.5417 6.59518 13.5417 6.25ZM13.5417 8.75C13.5417 8.40482 13.8215 8.125 14.1667 8.125H15.8333C16.1785 8.125 16.4583 8.40482 16.4583 8.75C16.4583 9.09518 16.1785 9.375 15.8333 9.375H14.1667C13.8215 9.375 13.5417 9.09518 13.5417 8.75Z" fill="black"/>
                        <path d="M15 12.0833C15.4602 12.0833 15.8333 11.7102 15.8333 11.25C15.8333 10.7898 15.4602 10.4167 15 10.4167C14.5398 10.4167 14.1667 10.7898 14.1667 11.25C14.1667 11.7102 14.5398 12.0833 15 12.0833Z" fill="black"/>
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5 14.375C5.34518 14.375 5.625 14.6548 5.625 15V17.5C5.625 17.8452 5.34518 18.125 5 18.125C4.65482 18.125 4.375 17.8452 4.375 17.5V15C4.375 14.6548 4.65482 14.375 5 14.375ZM15 14.375C15.3452 14.375 15.625 14.6548 15.625 15V17.5C15.625 17.8452 15.3452 18.125 15 18.125C14.6548 18.125 14.375 17.8452 14.375 17.5V15C14.375 14.6548 14.6548 14.375 15 14.375Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Washer'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.66666 5.83334C6.90277 5.83334 7.10083 5.75362 7.26083 5.59417C7.42027 5.43417 7.49999 5.23612 7.49999 5.00001C7.49999 4.76389 7.42027 4.56584 7.26083 4.40584C7.10083 4.24639 6.90277 4.16667 6.66666 4.16667C6.43055 4.16667 6.2325 4.24639 6.07249 4.40584C5.91305 4.56584 5.83333 4.76389 5.83333 5.00001C5.83333 5.23612 5.91305 5.43417 6.07249 5.59417C6.2325 5.75362 6.43055 5.83334 6.66666 5.83334ZM9.16666 5.83334C9.40277 5.83334 9.60083 5.75362 9.76083 5.59417C9.92027 5.43417 9.99999 5.23612 9.99999 5.00001C9.99999 4.76389 9.92027 4.56584 9.76083 4.40584C9.60083 4.24639 9.40277 4.16667 9.16666 4.16667C8.93055 4.16667 8.73277 4.24639 8.57333 4.40584C8.41333 4.56584 8.33333 4.76389 8.33333 5.00001C8.33333 5.23612 8.41333 5.43417 8.57333 5.59417C8.73277 5.75362 8.93055 5.83334 9.16666 5.83334ZM9.99999 15C10.875 15 11.6217 14.7014 12.24 14.1042C12.8578 13.5069 13.1667 12.7778 13.1667 11.9167C13.1667 11.5139 13.0972 11.1214 12.9583 10.7392C12.8194 10.3575 12.6111 10.0278 12.3333 9.75L9.99999 7.41667L7.74999 9.66667C7.44444 9.97223 7.21194 10.3158 7.0525 10.6975C6.8925 11.0797 6.81944 11.4861 6.83333 11.9167C6.86111 12.7778 7.18055 13.5069 7.79166 14.1042C8.40277 14.7014 9.13888 15 9.99999 15ZM9.99999 13.4167C9.58333 13.4167 9.22916 13.2708 8.9375 12.9792C8.64583 12.6875 8.49999 12.3333 8.49999 11.9167C8.49999 11.7083 8.53833 11.5103 8.615 11.3225C8.69111 11.1353 8.80555 10.9653 8.95833 10.8125L9.99999 9.77084L11.0208 10.7917C11.1736 10.9444 11.2917 11.1181 11.375 11.3125C11.4583 11.5069 11.5 11.7083 11.5 11.9167C11.5 12.3333 11.3542 12.6875 11.0625 12.9792C10.7708 13.2708 10.4167 13.4167 9.99999 13.4167ZM4.99999 18.3333C4.54166 18.3333 4.14944 18.1703 3.82333 17.8442C3.49666 17.5175 3.33333 17.125 3.33333 16.6667V3.33334C3.33333 2.87501 3.49666 2.4825 3.82333 2.15584C4.14944 1.82973 4.54166 1.66667 4.99999 1.66667H15C15.4583 1.66667 15.8508 1.82973 16.1775 2.15584C16.5036 2.4825 16.6667 2.87501 16.6667 3.33334V16.6667C16.6667 17.125 16.5036 17.5175 16.1775 17.8442C15.8508 18.1703 15.4583 18.3333 15 18.3333H4.99999ZM4.99999 16.6667H15V3.33334H4.99999V16.6667ZM4.99999 16.6667V3.33334V16.6667Z" fill="black"/>
                      </svg>
                    </span>
                    <span  v-if="amenity.name=='Dryer'" class="mr-2">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.66666 5.83334C6.90277 5.83334 7.10083 5.75362 7.26083 5.59417C7.42027 5.43417 7.49999 5.23612 7.49999 5.00001C7.49999 4.76389 7.42027 4.56584 7.26083 4.40584C7.10083 4.24639 6.90277 4.16667 6.66666 4.16667C6.43055 4.16667 6.2325 4.24639 6.07249 4.40584C5.91305 4.56584 5.83333 4.76389 5.83333 5.00001C5.83333 5.23612 5.91305 5.43417 6.07249 5.59417C6.2325 5.75362 6.43055 5.83334 6.66666 5.83334ZM9.16666 5.83334C9.40277 5.83334 9.60083 5.75362 9.76083 5.59417C9.92027 5.43417 9.99999 5.23612 9.99999 5.00001C9.99999 4.76389 9.92027 4.56584 9.76083 4.40584C9.60083 4.24639 9.40277 4.16667 9.16666 4.16667C8.93055 4.16667 8.73277 4.24639 8.57333 4.40584C8.41333 4.56584 8.33333 4.76389 8.33333 5.00001C8.33333 5.23612 8.41333 5.43417 8.57333 5.59417C8.73277 5.75362 8.93055 5.83334 9.16666 5.83334ZM9.99999 15C10.875 15 11.6217 14.7014 12.24 14.1042C12.8578 13.5069 13.1667 12.7778 13.1667 11.9167C13.1667 11.5139 13.0972 11.1214 12.9583 10.7392C12.8194 10.3575 12.6111 10.0278 12.3333 9.75L9.99999 7.41667L7.74999 9.66667C7.44444 9.97223 7.21194 10.3158 7.0525 10.6975C6.8925 11.0797 6.81944 11.4861 6.83333 11.9167C6.86111 12.7778 7.18055 13.5069 7.79166 14.1042C8.40277 14.7014 9.13888 15 9.99999 15ZM9.99999 13.4167C9.58333 13.4167 9.22916 13.2708 8.9375 12.9792C8.64583 12.6875 8.49999 12.3333 8.49999 11.9167C8.49999 11.7083 8.53833 11.5103 8.615 11.3225C8.69111 11.1353 8.80555 10.9653 8.95833 10.8125L9.99999 9.77084L11.0208 10.7917C11.1736 10.9444 11.2917 11.1181 11.375 11.3125C11.4583 11.5069 11.5 11.7083 11.5 11.9167C11.5 12.3333 11.3542 12.6875 11.0625 12.9792C10.7708 13.2708 10.4167 13.4167 9.99999 13.4167ZM4.99999 18.3333C4.54166 18.3333 4.14944 18.1703 3.82333 17.8442C3.49666 17.5175 3.33333 17.125 3.33333 16.6667V3.33334C3.33333 2.87501 3.49666 2.4825 3.82333 2.15584C4.14944 1.82973 4.54166 1.66667 4.99999 1.66667H15C15.4583 1.66667 15.8508 1.82973 16.1775 2.15584C16.5036 2.4825 16.6667 2.87501 16.6667 3.33334V16.6667C16.6667 17.125 16.5036 17.5175 16.1775 17.8442C15.8508 18.1703 15.4583 18.3333 15 18.3333H4.99999ZM4.99999 16.6667H15V3.33334H4.99999V16.6667ZM4.99999 16.6667V3.33334V16.6667Z" fill="black"/>
                      </svg>
                    </span>
                    <span>{{ amenity.name }}</span>
                  </p>

                </div>
              </div>
              <p
                v-if="getListing().amenities.length > 6"
                class="text-[16px] mt-4 font-bold"
                v-on:click="showAllAmenities = !showAllAmenities"
              >
                View all amenities and features
              </p>
            </div>
            <div class="mt-6 border"></div>
            <div class="mt-6">
              <p class="font-bold text-[20px]">Sleeping Options</p>
              <!-- <p class="mb-2">{{ getListing().bedroom_details }}</p> -->
              <div class="columns-4 mt-6">
                <div
                  v-for="(bedroom, index) in getListing().bedrooms"
                  :key="index"
                  class="mb-2"
                >
                  <p class="font-bold">Bedroom {{index + 1}}</p>
                  <div>
                    <p v-for="amenity in bedroom.amenities" :key="amenity.id"
                        >{{ amenity.name }}
                    </p>
                  </div>
                </div>
                <div
                  v-for="(bathroom, index) in getListing().bathrooms"
                  :key="index"
                >
                  <p class="font-bold">Bathroom {{index + 1}}</p>
                  <div>
                    <p v-for="amenity in bathroom.amenities" :key="amenity.id"
                        >{{ amenity.name }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="mt-6 border"></div>


      <div class="mt-6" v-if="listing.length > 0">
        <div class="flex items-center">
          <p class="font-bold text-[20px] m-0">Reviews</p>
          <div class="flex items-center ml-4">
            <svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1.21836 5.42154L5.36389 4.81906L7.21706 1.06212C7.26767 0.959255 7.35094 0.875985 7.45381 0.82537C7.71178 0.698016 8.02527 0.804145 8.15425 1.06212L10.0074 4.81906L14.153 5.42155C14.2672 5.43787 14.3717 5.49175 14.4517 5.57339C14.5485 5.6728 14.6018 5.80655 14.5999 5.94523C14.5981 6.08392 14.5413 6.21621 14.442 6.31302L11.4426 9.23727L12.1512 13.3665C12.1678 13.4625 12.1572 13.5613 12.1205 13.6516C12.0839 13.742 12.0226 13.8202 11.9437 13.8775C11.8649 13.9348 11.7715 13.9688 11.6743 13.9757C11.5771 13.9827 11.4798 13.9622 11.3936 13.9167L7.68566 11.9672L3.97769 13.9167C3.87646 13.9706 3.75891 13.9886 3.64625 13.969C3.36215 13.92 3.17112 13.6506 3.2201 13.3665L3.92871 9.23727L0.929361 6.31302C0.847724 6.23302 0.793844 6.12852 0.777517 6.01423C0.733432 5.7285 0.932626 5.464 1.21836 5.42154Z" fill="black"/>
            </svg>
            <span class="font-bold">
              {{getListing()?.rating}}
            </span>
            <span class="text-gray-500">
              &nbsp;({{getListing()?.total_reviews }})
            </span>
          </div>
        </div>
        <div class="sm:w-[70%] md:w-[100%]">
          <ListingReviews v-if="hasReviews" :reviews="reviews" />
          <p class="font-bold text-[16px] cursor-pointer" @click="showAllReviews=true">View all reviews</p>
        </div>
      </div>
      <div class="mt-6 border"></div>
      <div class="mt-6">
        <div class="flex items-center">
          <p class="font-bold text-[20px] m-0">Get to know the area</p>
        </div>
        <div class="sm:w-[70%] md:w-[100%] mt-6">
          <LocationSearchMap
            @bounds_changed="getMapBounds"
            :markers="markers"
            :selected="selectedListing"
            @marker-click="selectListing($event)"
            :detail="true"
            />
        </div>
        <div class="flex items-center">
          <p class="font-bold text-[16px] mt-6" v-if="listing.length">{{ getListing().address.city }}, {{ getListing().address.state }}</p>
        </div>
      </div>
    </div>
    </div>
    </div>
    <vue-final-modal
      :click-to-close="false"
      v-model="openFavoriteModal"
      classes="flex justify-center items-center px-10"
      content-class="relative flex flex-col max-h-full mx-4 p-4 border dark:border-gray-800 rounded bg-white dark:bg-gray-900"
    >
      <span v-on:click="openFavoriteModal=false" class="cursor-pointer"><svg class="w-5 h-5  float-right" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></span>
      <span class="text-xl font-bold text-center mt-2">
        <slot name="title">Select Favorite</slot>
      </span>
      <div class="grid mt-4 space-y-2">
        <div class="py-4 border px-3 cursor-pointer rounded-lg flex justify-between items-center" v-for="page in stayPageLists">
          <div>
              <span @click="goToStayPage(page.id)" class="font-bold-md hover:underline">{{page.name}}</span>
          </div>
          <div class="ml-4" @click="addStayPage(page.id)">
              <span v-if="isFavorited(page.id)"><svg class="w-3 cursor-pointer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z"/></svg></span>
              <span v-else><svg class="w-3 cursor-pointer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M336 0h-288C21.49 0 0 21.49 0 48v431.9c0 24.7 26.79 40.08 48.12 27.64L192 423.6l143.9 83.93C357.2 519.1 384 504.6 384 479.9V48C384 21.49 362.5 0 336 0zM336 452L192 368l-144 84V54C48 50.63 50.63 48 53.1 48h276C333.4 48 336 50.63 336 54V452z"/></svg></span>
          </div>
        </div>
      </div>
    </vue-final-modal>
    <vue-final-modal v-if="listing.length > 0"
      v-model="showAllAmenities"
      :click-to-close="false"
      classes="flex justify-center items-center"
      content-class="relative flex flex-col max-h-full mx-4 p-10 border dark:border-gray-800 rounded-3xl bg-white dark:bg-gray-900 sm:w-[560px] md:w-[860px] w-full"
    >
      <span v-on:click="showAllAmenities=false" class="cursor-pointer absolute top-4 right-4"><svg class="w-6 h-6 float-right" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></span>
      <div>
        <p class="text-[#DE774A] text-[28px] font-bold">Amenities</p>
      </div>
      <div class="flex-grow overflow-y-auto mt-2">
        <div class="mt-4 space-y-2">
          <div v-for="category in getCategory()" class="p-4">
            <p class="font-bold">{{category.key}}</p>
            <div class="py-2 columns-3">
              <div v-for="title in category.value" class="">
                <p class="">
                  {{title.name}}
                </p>
              </div>
            </div>
          </div>
          <!-- <p>{{getCategory()}}</p> -->
          <!-- <div v-for="amenity in getCategory().amenities" :key="amenity.id">
            <p>{{ amenity.name }}</p>
          </div> -->
        </div>
      </div>
    </vue-final-modal>
    <vue-final-modal v-if="listing.length > 0"
      v-model="showAllReviews"
      :click-to-close="false"
      classes="flex justify-center items-center"
      content-class="relative flex flex-col max-h-full mx-4 p-10 border dark:border-gray-800 rounded-3xl bg-white dark:bg-gray-900 sm:w-[560px] md:w-[860px] w-full"
    >
      <span v-on:click="showAllReviews=false" class="cursor-pointer absolute top-4 right-4"><svg class="w-6 h-6 float-right" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></span>
      <div>
        <p class="text-[#DE774A] text-[28px] font-bold">Reviews</p>
      </div>
      <div class="flex-grow overflow-y-auto">
        <div class="">
          <ListingReviews v-if="hasReviews" :reviews="allReviews" />
        </div>
      </div>
    </vue-final-modal>
    <vue-final-modal v-if="listing.length > 0"
      v-model="showFullDescription"
      :click-to-close="false"
      classes="flex justify-center items-center"
      content-class="relative flex flex-col max-h-full mx-4 p-10 border dark:border-gray-800 rounded-3xl bg-white dark:bg-gray-900 sm:w-[560px] md:w-[860px] w-full"
    >
      <span v-on:click="showFullDescription=false" class="cursor-pointer absolute top-4 right-4"><svg class="w-6 h-6 float-right" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></span>
      <div>
        <p class="text-[#DE774A] text-[28px] font-bold">{{ getListing().name }} Description</p>
      </div>
      <div class="flex-grow overflow-y-auto mt-6">

        <p class="mt-3 mb-5">{{ getListing().accommodations_summary }}</p>

        <p>
          {{ getListing().description }}
        </p>
      </div>
    </vue-final-modal>
    <VerifyModal :emailVerifyModal="emailVerifyModal" :close="closeModal"/>
  </div>
</template>

<script lang="ts">
export default {
  data() {
    const userStore = UserStore();
    const { is_login: is_login} = storeToRefs(userStore);
    const { isLoggedIn: isLoggedIn } = storeToRefs(userStore);
    const { isVerify: isVerify } = storeToRefs(userStore);
    const data = {
      isLoggedIn: isLoggedIn,
      is_login: is_login,
      listing: Array<Listing>(),
      showFullDescription: false,
      showAllAmenities: false,
      openFavoriteModal: false,
      isLoggedIn: isLoggedIn,
      stayPageLists: [],
      list_id: '',
      favoritePages: [],
      showAllReviews: false,
      selectedListing: "",
      isVerify: isVerify,
      emailVerifyModal: false
    };
    return data;
  },
  mounted() {
    let listingID = this.$route.params.id as string;
    if (!listingID) {
      listingID = this.listing_id
    }

    if(listingID) {
      this.list_id = listingID;
      if (this.isLoggedIn) {
        this.getStayPageList();
        this.getFavoritePages();
      }
      ListingService.getListing(listingID).then((response) => {
        const prop: Listing = <Listing>response.data;
        this.listing.push(prop);
      });
    }
  },

  computed: {
    hasReviews() {
      return this.listing.length && this.listing[0]?.reviews?.length > 0;
    },
    reviews() {
      return this.hasReviews ? this.listing[0]?.reviews.slice(
          0,
          Math.min(this.listing[0]?.reviews.length, 3)) : [];
    },
    allReviews() {
      return this.hasReviews ? this.listing[0]?.reviews : [];
    },

    markers(): MapMarker[] {
      return this.listing.reduce(
        (markers: MapMarker[], { id, name, address }) => {
          const title = name;
          const position = {
            lat: parseFloat(address.latitude.toString()),
            lng: parseFloat(address.longitude.toString()),
          };
          markers.push({ id, title, position });

          return markers;
        },
        []
      );
    },
  },

  methods: {
    selectListing(id: string) {
      this.selectedListing = id;
    },
    getMapBounds(event) {
      console.log(event)
    },
    openModal() {
      if(this.isLoggedIn) {
        this.openFavoriteModal = true
      }else {
        this.is_login = true;
      }
    },
    connectHost(link: any) {
      event('connectHost', { method: 'Google' })
      if(this.isLoggedIn) {
        if(this.isVerify) {
          window.open(link, '_blank');
        }else {
          this.emailVerifyModal = true
        }
      }else {
        this.is_login = true;
      }
    },
    goToStayPage (id: any) {
      // this.$router.push("/stay-detail/" + id);
      window.open("/stay-detail/" + id, '_blank');
    },

    getCategory() {
      const groupByCategory = this.listing[0].amenities.reduce((group, product) => {
        const { category } = product;
        group[category] = group[category] ?? [];
        group[category].push(product);
        return group;
      }, {});
      let categories = [];
      for (var key in groupByCategory) {
        categories.push({key: key, value: groupByCategory[key]})
      }
      console.log(categories);
      return categories
    },

    getListing() {
      return this.listing[0];
    },

    isFavorited(page_id : any) {
      let filters = this.favoritePages.filter((x, i) => x.id == page_id);
      if(filters.length > 0) {
        return true;
      }else{
        return false;
      }
    },

    closeModal() {
      // some code...
      this.emailVerifyModal = false;
      this.showAllAmenities = false;
    },

    getStayPageList() {
      AccountsService.getStayPages().then((res) => {
        this.stayPageLists = res;
      })
    },

    getFavoritePages() {
      ListingService.getFavoritePages(this.list_id).then((res) => {
        if(res.status === 200) {
          this.favoritePages = res.data
        }
        // const prop: Listing = <Listing>response.data;
        // this.listing.push(prop);
      })
    },

    addStayPage(page_id: any) {
      AccountsService.addStayPage({list_id: this.list_id, page_id: page_id}).then((res) => {
        this.getFavoritePages();
      })
    }
  },
  props: ["listing_id"],
};
</script>
